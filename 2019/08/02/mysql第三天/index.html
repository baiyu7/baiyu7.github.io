<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.1.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="1 表连接​         12345sql表连接分为内连接,外连接和交叉连接1) 内连接	//a: 使用where进行连接	select stu.stuName,sch.schName from student stu,school sch where stu.schoolId=sch.id ​1234567//b:使用join的方式进行连接,并且加条件//通常使用第一种样式select st">
<meta property="og:type" content="article">
<meta property="og:title" content="mysql第三天">
<meta property="og:url" content="http://yoursite.com/2019/08/02/mysql第三天/index.html">
<meta property="og:site_name" content="生活不止眼前的苟且，还有诗和远方。">
<meta property="og:description" content="1 表连接​         12345sql表连接分为内连接,外连接和交叉连接1) 内连接	//a: 使用where进行连接	select stu.stuName,sch.schName from student stu,school sch where stu.schoolId=sch.id ​1234567//b:使用join的方式进行连接,并且加条件//通常使用第一种样式select st">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-08-02T11:52:47.384Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="mysql第三天">
<meta name="twitter:description" content="1 表连接​         12345sql表连接分为内连接,外连接和交叉连接1) 内连接	//a: 使用where进行连接	select stu.stuName,sch.schName from student stu,school sch where stu.schoolId=sch.id ​1234567//b:使用join的方式进行连接,并且加条件//通常使用第一种样式select st">





  
  
  <link rel="canonical" href="http://yoursite.com/2019/08/02/mysql第三天/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>mysql第三天 | 生活不止眼前的苟且，还有诗和远方。</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">生活不止眼前的苟且，还有诗和远方。</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/02/mysql第三天/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content>
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="生活不止眼前的苟且，还有诗和远方。">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">mysql第三天

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-08-02 19:50:51 / 修改时间：19:52:47" itemprop="dateCreated datePublished" datetime="2019-08-02T19:50:51+08:00">2019-08-02</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/mysql/" itemprop="url" rel="index"><span itemprop="name">mysql</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="1-表连接"><a href="#1-表连接" class="headerlink" title="1 表连接"></a>1 表连接</h1><p>​        </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sql表连接分为内连接,外连接和交叉连接</span><br><span class="line"></span><br><span class="line">1) 内连接</span><br><span class="line">	//a: 使用where进行连接</span><br><span class="line">	select stu.stuName,sch.schName from student stu,school sch where stu.schoolId=sch.id</span><br></pre></td></tr></table></figure>
<p>​<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//b:使用join的方式进行连接,并且加条件</span><br><span class="line">//通常使用第一种样式</span><br><span class="line">select stu.stuName,sch.schName from student stu JOIN school sch ON stu.schoolId=sch.id where stu.stuName like &apos;李%&apos;</span><br><span class="line">或者</span><br><span class="line">select stu.stuName,sch.schName from student stu JOIN school sch ON stu.schoolId=sch.id and stu.stuName like &apos;李%&apos;</span><br><span class="line">或者</span><br><span class="line">select stu.stuName,sch.schName from student stu JOIN school sch where stu.schoolId=sch.id and stu.stuName like &apos;李%&apos;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">	特点:如果a表有4条记录,b表有2条记录,使用内连接只会查询两个表有匹配条件的数据</span><br><span class="line">	</span><br><span class="line">	如果有三张表</span><br><span class="line">	select * from a,b,c</span><br><span class="line">	WHERE</span><br><span class="line">	a.bid=b.id</span><br><span class="line">	AND</span><br><span class="line">	b.cid=c.id</span><br><span class="line">	将至少两个连接条件,否则数据不正确</span><br><span class="line">	所以对于n张表来说,至少有n-1个连接条件</span><br><span class="line">	</span><br><span class="line">2)外连接</span><br><span class="line">	1.左连接</span><br><span class="line">		左连接使用 left join</span><br><span class="line">		select stu.stuName,sch.schName from student stu LEFT JOIN school sch ON stu.schoolId=sch.id</span><br><span class="line">		</span><br><span class="line">		张三	Null</span><br><span class="line">		李四	东方</span><br><span class="line">		王五	师大</span><br><span class="line">		赵六	师大</span><br><span class="line">		小淘气	远东</span><br><span class="line">		李子	Null</span><br><span class="line">		</span><br><span class="line">		特点:会将左表的数据全部显示出来,右表没有与之对应的数据用Null显示</span><br><span class="line">	</span><br><span class="line">	2.右连接</span><br><span class="line">		同左连接一样,只是使用的关键字 right join,把右表的数据全部展示,左表用Null填充</span><br><span class="line">		select stu.stuName,sch.schName from student stu RIGHT JOIN school sch ON stu.schoolId=sch.id</span><br><span class="line">		或者使用左连接,把表换个位置即可</span><br><span class="line">	</span><br><span class="line">	3.全外连接</span><br><span class="line">		mysql不支持 全外连接 //sql server 支持 full join</span><br><span class="line">		可以使用union就是替代了全外连接</span><br><span class="line">		特点就是:两个表数据都将展示出来,没有的互相以null替代</span><br><span class="line">		</span><br><span class="line">3) 交叉连接</span><br><span class="line">	没有where条件语句,他返回连接表中所有数据的笛卡尔积</span><br><span class="line">	select * from student stu,school sch</span><br><span class="line">	</span><br><span class="line">	比如 a表有3条记录</span><br><span class="line">	b表有4条记录</span><br><span class="line">	</span><br><span class="line">	笛卡尔积是 3*4=12条</span><br></pre></td></tr></table></figure>
<p>​<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">create table T_Customers(</span><br><span class="line">	Id int not null,</span><br><span class="line">	Name varchar(50) null,</span><br><span class="line">	Age int Null</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">create Table T_Orders(</span><br><span class="line">	Id int not null,</span><br><span class="line">	BillNo varchar(50) Null,</span><br><span class="line">	CustomerId int null</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">	INSERT INTO T_Customers (Id, Name, Age) VALUES (1, &apos;tom&apos;, 10);</span><br><span class="line">	INSERT INTO T_Customers (Id, Name, Age) VALUES (2, &apos;jerry&apos;, 15);</span><br><span class="line">	INSERT INTO T_Customers (Id, Name, Age) VALUES (3, &apos;john&apos;, 22);</span><br><span class="line">	INSERT INTO T_Customers (Id, Name, Age) VALUES (4, &apos;lily&apos;, 18);</span><br><span class="line">	INSERT INTO T_Customers (Id, Name, Age) VALUES (5, &apos;lucy&apos;, 18);</span><br><span class="line">	</span><br><span class="line">    INSERT INTO  T_Orders  ( Id ,  BillNo ,  CustomerId ) VALUES (1, &apos;001&apos;, 1);</span><br><span class="line">	INSERT INTO  T_Orders  ( Id ,  BillNo ,  CustomerId ) VALUES (2, &apos;002&apos;, 1);</span><br><span class="line">	INSERT INTO  T_Orders  ( Id ,  BillNo ,  CustomerId ) VALUES (3, &apos;003&apos;, 3);</span><br><span class="line">	INSERT INTO  T_Orders  ( Id ,  BillNo ,  CustomerId ) VALUES (4, &apos;004&apos;, 2);</span><br><span class="line">	INSERT INTO  T_Orders  ( Id ,  BillNo ,  CustomerId ) VALUES (5, &apos;005&apos;, 2);</span><br><span class="line">	INSERT INTO  T_Orders  ( Id ,  BillNo ,  CustomerId ) VALUES (6, &apos;006&apos;, 5);</span><br><span class="line">	INSERT INTO  T_Orders  ( Id ,  BillNo ,  CustomerId ) VALUES (7, &apos;007&apos;, 4);</span><br><span class="line">	INSERT INTO  T_Orders  ( Id ,  BillNo ,  CustomerId ) VALUES (8, &apos;008&apos;, 5);</span><br></pre></td></tr></table></figure></p>
<p>​<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//查询每个订单都是谁的?</span><br><span class="line">	select o.BillNo,c.`Name` from t_orders o LEFT JOIN t_customers c on o.CustomerId=c.Id</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//显示出大于15岁的客户的订单号,客户姓名,年龄</span><br><span class="line">	select o.BillNo,c.`Name`,c.Age from t_customers c LEFT JOIN t_orders o ON c.Id=o.CustomerId where c.Age&gt;15</span><br><span class="line"></span><br><span class="line">//显示出年龄大于平均年龄的所有客户的订单</span><br><span class="line">	select c.`Name`,o.BillNo,c.Age from t_customers c LEFT JOIN t_orders o ON c.Id=o.CustomerId where c.Age&gt;(select avg(Age) from t_customers)</span><br></pre></td></tr></table></figure>
<h1 id="2-子查询-嵌套查询"><a href="#2-子查询-嵌套查询" class="headerlink" title="2 子查询 (嵌套查询)"></a>2 子查询 (嵌套查询)</h1><p>​        </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">将一个查询语句作为一个结果集给其他sql使用</span><br><span class="line">就是子查询,几乎所有的查询,都能改成子查询</span><br><span class="line"></span><br><span class="line">//例子</span><br><span class="line">select * from t_student where score&gt;60</span><br><span class="line">//子查询</span><br><span class="line">select * from (select * from t_student where score&gt;60) as temp</span><br><span class="line"></span><br><span class="line">查询最高分的人</span><br><span class="line">select  max(score) from t_student</span><br><span class="line">//子查询</span><br><span class="line">select * from t_student score=(</span><br><span class="line">	select Max(score) from t_student</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">//查询分数在50到80之间的男同学</span><br><span class="line">select * from t_student s where s.score between 50 and 80 and s.sex=&apos;男&apos;</span><br><span class="line">//子查询</span><br><span class="line">select * from t_student where score in(</span><br><span class="line">	select s.score from t_student s where s.score between 50 and 80</span><br><span class="line">) and sex=&apos;男&apos;</span><br><span class="line"></span><br><span class="line">union all&gt;union&gt;连接查询&gt;子查询</span><br><span class="line">它们的速度依次变慢,速度越慢的sql,就越容易引起死锁,而且会让服务器越来越慢</span><br></pre></td></tr></table></figure>
<h1 id="3-索引"><a href="#3-索引" class="headerlink" title="3 索引"></a>3 索引</h1><p>​        </p>
<pre><code>索引的作用就是为了加快检索的速度

1．索引作用
数据库利用各种各样的快速定位技术，能够大大提高查询select效率。
特别是当数据量非常大，查询涉及多个表时，使用索引往往能使查询速度加快成千上万倍。
索引可以加快检索的速度，但是对频繁修改的字段，效率并不好，会重建索引
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">例如，</span><br><span class="line">有3个未索引的表t1、t2、t3，分别只包含列c1、c2、c3，每个表分别含有1000行数据组成，指为1～1000的数值，</span><br><span class="line">查找对应值相等行的查询如下所示。</span><br><span class="line">SELECT c1,c2,c3 FROM t1,t2,t3 WHERE c1=c2 AND c1=c3</span><br><span class="line"></span><br><span class="line">此查询结果应该为1000行，每行包含3个相等的值。</span><br><span class="line">在无索引的情况下处理此查询，必须寻找3个表所有的组合，</span><br><span class="line">以便得出与WHERE子句相配的那些行。而可能的组合数目为1000×1000×1000（十亿），显然查询将会非常慢。</span><br><span class="line"></span><br><span class="line">如果对每个表进行索引，就能极大地加速查询进程。利用索引的查询处理如下。</span><br><span class="line">（1）从表t1中选择第一行，查看此行所包含的数据。</span><br><span class="line">（2）使用表t2上的索引，直接定位t2中与t1的值匹配的行。</span><br><span class="line">     类似，利用表t3上的索引，直接定位t3中与来自t1的值匹配的行。</span><br><span class="line">（3）扫描表t1的下一行并重复前面的过程，直到遍历t1中所有的行。</span><br><span class="line"></span><br><span class="line">在此情形下，仍然对表t1执行了一个完全扫描，但能够在表t2和t3上进行索引查找直接取出这些表中的行，</span><br><span class="line">比未用索引时快了很多很多倍。</span><br><span class="line"></span><br><span class="line">利用索引，MySQL加速了WHERE子句满足条件行的搜索，而在多表连接查询时，</span><br><span class="line">在执行连接时加快了与其他表中的行匹配的速度。</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">2. 创建索引</span><br><span class="line">   第一种在执行create table就直接指定</span><br><span class="line">   第二种alter table 进行修改添加索引</span><br><span class="line">   </span><br><span class="line">   索引大体分为 普通索引 unique 主键索引</span><br><span class="line">   第一种:</span><br><span class="line">	create table user(</span><br><span class="line">		id int not null,</span><br><span class="line">		userName varchar(16) not null,</span><br><span class="line">		index myIndex (userName(16))</span><br><span class="line">	)</span><br><span class="line">	第二种:</span><br><span class="line">	alter table user add index myIndex(userName)</span><br><span class="line">	</span><br><span class="line">3. 查看索引</span><br><span class="line">	show index from 表名</span><br><span class="line">		· Table 表的名称。</span><br><span class="line">	　　· Non_unique 如果索引不能包括重复词，则为0。如果可以，则为1。</span><br><span class="line">	　　· Key_name 索引的名称。</span><br><span class="line">	　　· Seq_in_index 索引中的列序列号，从1开始。</span><br><span class="line">	　　· Column_name列名称。</span><br><span class="line">	　　· Collation列以什么方式存储在索引中。在MySQL中，有值‘A’（升序）或NULL（无分类）。</span><br><span class="line">	　　· Cardinality索引中唯一值的数目的估计值。通过运行ANALYZE TABLE或myisamchk -a可以更新。</span><br><span class="line">					基数根据被存储为整数的统计数据来计数，所以即使对于小型表，该值也没有必要是精确的。</span><br><span class="line">					基数越大，当进行联合时，MySQL使用该索引的机会就越大。</span><br><span class="line">	　　· Sub_part如果列只是被部分地编入索引，则为被编入索引的字符的数目。如果整列被编入索引，则为NULL。</span><br><span class="line">	　　· Packed指示关键字如何被压缩。如果没有被压缩，则为NULL。</span><br><span class="line">	　　· Null如果列含有NULL，则含有YES。如果没有，则该列含有NO。</span><br><span class="line">	　　· Index_type用过的索引方法（BTREE, FULLTEXT, HASH）。</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">检查sql的执行效率 explain</span><br><span class="line">explain SELECT c1,c2,c3 FROM t1,t2,t3 WHERE c1=c2 AND c1=c3</span><br><span class="line"></span><br><span class="line">各个属性的含义：</span><br><span class="line">	id：select查询的序列号</span><br><span class="line">	select_type：select查询的类型，主要是区别普通查询和联合查询、子查询之类的复杂查询。</span><br><span class="line">	table：输出的行所引用的表。</span><br><span class="line">	type：联合查询所使用的类型。</span><br><span class="line">	     type显示的是访问类型，是较为重要的一个指标，结果值从好到坏依次是：</span><br><span class="line">		 system &gt; const &gt; eq_ref &gt; ref &gt; fulltext &gt; ref_or_null &gt; index_merge &gt; unique_subquery &gt; index_subquery &gt; range &gt; index &gt; ALL</span><br><span class="line">		 一般来说，得保证查询至少达到range级别，最好能达到ref。</span><br><span class="line">	possible_keys：指出MySQL能使用哪个索引在该表中找到行。如果是空的，没有相关的索引。这时要提高性能，可通过检验WHERE子句，看是否引用某些字段，或者检查字段不是适合索引。</span><br><span class="line">	key：显示MySQL实际决定使用的键。如果没有索引被选择，键是NULL。</span><br><span class="line">	key_len：显示MySQL决定使用的键长度。如果键是NULL，长度就是NULL。文档提示特别注意这个值可以得出一个多重主键里mysql实际使用了哪一部分。</span><br><span class="line">	ref：显示哪个字段或常数与key一起被使用。</span><br><span class="line">	rows：这个数表示mysql要遍历多少数据才能找到，在innodb上是不准确的。</span><br><span class="line">	Extra： Using where：表示优化器需要通过索引回表查询数据；</span><br><span class="line">			Using index：表示直接访问索引就足够获取到所需要的数据，不需要通过索引回表；</span><br><span class="line">			Using index condition：在5.6版本后加入的新特性（Index Condition Pushdown）;</span><br><span class="line">			会先条件过滤索引，过滤完索引后找到所有符合索引条件的数据行，随后用 WHERE 子句中的其他条件去过滤这些数据行；</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">什么情况下不适合</span><br><span class="line">	经常做插入删除修改表的动作</span><br><span class="line">	表的记录很少</span><br><span class="line">	</span><br><span class="line">附:</span><br><span class="line">	Normal 就是普通索引</span><br><span class="line">	unique  唯一索引</span><br><span class="line">	full text 全文搜索索引  对于innodb不存在,对于myisam存在</span><br></pre></td></tr></table></figure>
<h1 id="4-sql优化"><a href="#4-sql优化" class="headerlink" title="4 sql优化"></a>4 sql优化</h1><p>​        </p>
<pre><code>在sql查询中为了提高查询效率，我们常常会采取一些措施对查询语句进行sql优化，下面总结的一些方法，
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">1.对查询进行优化，应尽量避免全表扫描，首先应考虑在 where 及 order by 涉及的列上建立索引。	</span><br><span class="line">2.应尽量避免在 where 子句中对字段进行 null 值判断，否则将导致引擎放弃使用索引而进行全表扫描，如：	</span><br><span class="line">select id from t where num is null	</span><br><span class="line">可以在num上设置默认值0，确保表中num列没有null值，然后这样查询：	</span><br><span class="line">select id from t where num=0		</span><br><span class="line">3.应尽量避免在 where 子句中使用!=或&lt;&gt;操作符，否则将引擎放弃使用索引而进行全表扫描。		</span><br><span class="line">4.应尽量避免在 where 子句中使用 or 来连接条件，否则将导致引擎放弃使用索引而进行全表扫描，如：	</span><br><span class="line">select id from t where num=10 or num=20	</span><br><span class="line">可以这样查询：	</span><br><span class="line">select id from t where num=10	</span><br><span class="line">union all	</span><br><span class="line">select id from t where num=20		</span><br><span class="line">5.in 和 not in 也要慎用，否则会导致全表扫描，如：	</span><br><span class="line">select id from t where num in(1,2,3)	</span><br><span class="line">对于连续的数值，能用 between 就不要用 in 了：	</span><br><span class="line">select id from t where num between 1 and 3		</span><br><span class="line">6.应尽量避免在 where 子句中对字段进行表达式操作，这将导致引擎放弃使用索引而进行全表扫描。如：	</span><br><span class="line">select id from t where num/2=100	</span><br><span class="line">应改为:	</span><br><span class="line">select id from t where num=100*2		</span><br><span class="line">7.应尽量避免在where子句中对字段进行函数操作，这将导致引擎放弃使用索引而进行全表扫描。如：	</span><br><span class="line">select id from t where substring(name,1,3)=&apos;abc&apos;--name以abc开头的id	</span><br><span class="line">应改为:	</span><br><span class="line">select id from t where name like &apos;abc%&apos;		</span><br><span class="line">8.不要在 where 子句中的“=”左边进行函数、算术运算或其他表达式运算，否则系统将可能无法正确使用索引。		</span><br><span class="line">9.在使用索引字段作为条件时，如果该索引是复合索引，那么必须使用到该索引中的第一个字段作为条件时才能保证系统使用该索引，	</span><br><span class="line">否则该索引将不会被使用，并且应尽可能的让字段顺序与索引顺序相一致。				</span><br><span class="line">11.很多时候用 exists 代替 in 是一个好的选择：	</span><br><span class="line">select num from a where num in(select num from b)	</span><br><span class="line">用下面的语句替换：	</span><br><span class="line">select num from a where exists(select num from b where num=a.num)		</span><br><span class="line">12.并不是所有索引对查询都有效，SQL是根据表中数据来进行查询优化的，当索引列有大量数据重复时，SQL查询可能不会去利用索引，	</span><br><span class="line">如一表中有字段sex，male、female几乎各一半，那么即使在sex上建了索引也对查询效率起不了作用。		</span><br><span class="line">13.索引并不是越多越好，索引固然可以提高相应的 select 的效率，但同时也降低了 insert 及 update 的效率，	</span><br><span class="line">因为 insert 或 update 时有可能会重建索引，所以怎样建索引需要慎重考虑，视具体情况而定。	</span><br><span class="line">一个表的索引数最好不要超过6个，若太多则应考虑一些不常使用到的列上建的索引是否有必要。	</span><br><span class="line">14.尽量使用数字型字段，若只含数值信息的字段尽量不要设计为字符型，这会降低查询和连接的性能，并会增加存储开销。	</span><br><span class="line">这是因为引擎在处理查询和连接时会逐个比较字符串中每一个字符，而对于数字型而言只需要比较一次就够了。		</span><br><span class="line">15.尽可能的使用 varchar 代替 char ，因为首先变长字段存储空间小，可以节省存储空间，	</span><br><span class="line">其次对于查询来说，在一个相对较小的字段内搜索效率显然要高些。		</span><br><span class="line">16.任何地方都不要使用 select * from t ，用具体的字段列表代替“*”，不要返回用不到的任何字段。		</span><br><span class="line">17.避免频繁创建和删除临时表，以减少系统表资源的消耗。</span><br><span class="line">18.临时表并不是不可使用，适当地使用它们可以使某些例程更有效，例如，当需要重复引用大型表或常用表中的某个数据集时。但是，对于一次性事件，最好使用导出表。		</span><br><span class="line">19.在新建临时表时，如果一次性插入数据量很大，那么可以使用 select into 代替 create table，避免造成大量 log ，	</span><br><span class="line">以提高速度；如果数据量不大，为了缓和系统表的资源，应先create table，然后insert。</span><br><span class="line">20.如果使用到了临时表，在存储过程的最后务必将所有的临时表显式删除，先 truncate table ，然后 drop table ，这样可以避免系统表的较长时间锁定。		</span><br><span class="line">21.尽量避免使用游标，因为游标的效率较差，如果游标操作的数据超过1万行，那么就应该考虑改写。		</span><br><span class="line">22.使用基于游标的方法或临时表方法之前，应先寻找基于集的解决方案来解决问题，基于集的方法通常更有效。</span><br><span class="line">23.与临时表一样，游标并不是不可使用。对小型数据集使用 FAST_FORWARD 游标通常要优于其他逐行处理方法，尤其是在必须引用几个表才能获得所需的数据时。</span><br><span class="line">在结果集中包括“合计”的例程通常要比使用游标执行的速度快。如果开发时间允许，基于游标的方法和基于集的方法都可以尝试一下，看哪一种方法的效果更好。</span><br><span class="line">24.尽量避免大事务操作，提高系统并发能力。26.尽量避免向客户端返回大数据量，若数据量过大，应该考虑相应需求是否合理</span><br><span class="line"></span><br><span class="line">exists和in 的区别</span><br><span class="line">in</span><br><span class="line">select * from student s where s.id in(</span><br><span class="line">	select stuId from score ss,student s where ss.stuId=s.id</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">exists</span><br><span class="line">select * from student s where exists(</span><br><span class="line">	select stuId from score ss,student s where ss.stuId=s.id</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>====================================================================<br>1 假设a表有10条数据, b 表有 8条数据  做一个左连接查询,最后有多少条数据?   10条</p>
<p>2 表中有A B C三列,用SQL语句实现：当A列大于B列时选择A列否则选择B列，当B列大于C列时选择B列否则选择C列    </p>
<pre><code>select
   (
   case
       when a&gt;b then a
       else b
       end
   ),
   (
   case
       when b&gt;c then b
       else c
       end
   )
   from t
</code></pre><p>3       单号   金额<br>        Rk1     10<br>        Rk2     20<br>        Rk3     -30<br>        Rk4     -10</p>
<pre><code>将上面的表输出为如下的格式：

单号   收入   支出
Rk1     10       0
Rk2     20       0
Rk3      0       30
Rk4      0       10


select 单号,
(
case
    when 金额&gt;0 then 金额
    else 0
end
) as 收入,
(
case
    when 金额&lt;0 then abs(金额)
    else 0
end
) as 支出
from 表
</code></pre><p>4  有一张表T_Scores，记录比赛成绩<br>            Date                Name   Score<br>            2008-8-8          拜仁       胜<br>            2008-8-9          奇才       胜<br>            2008-8-9          湖人       胜<br>            2008-8-10         拜仁       负<br>            2008-8-8          拜仁       负<br>            2008-8-12         奇才       胜</p>
<pre><code>    要求输出下面的格式：
    Name      胜     负
    拜仁      1         2
    湖人      1         0
    奇才      2         0


select Name,
    sum((
    case Score
        when &apos;胜&apos; then 1
        else 0
    end
    )) as 胜,
    sum((
    case Score
        when &apos;负&apos; then 1
        else 0
    end
    )) as 负
from T_Scores
group by Name
</code></pre><p>​<br>5 查询英文名字是不缺分大小写的<br>    需要加BINARY来区别<br>    select * from student where BINARY stuName like ‘A%’</p>
<pre><code>create table user(
    userName varchar(20) binary,
    age int
)
</code></pre><p>6 null 代表什么 ? 如何查询 为null 的值<br>    null 代表”不知道”  is null 或 is not null </p>
<pre><code>还有一个函数 IFNULL (param1,param2)
</code></pre><p>7 char 和 varchar的区别</p>
<p>​<br>​<br>​<br>​    </p>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/08/02/mysql第二天/" rel="next" title="mysql第二天">
                <i class="fa fa-chevron-left"></i> mysql第二天
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/08/03/java继承问题/" rel="prev" title="Java 子类 继承 父类 所有属性、方法">
                Java 子类 继承 父类 所有属性、方法 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">46</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">7</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
            </nav>
          

          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-表连接"><span class="nav-number">1.</span> <span class="nav-text">1 表连接</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-子查询-嵌套查询"><span class="nav-number">2.</span> <span class="nav-text">2 子查询 (嵌套查询)</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-索引"><span class="nav-number">3.</span> <span class="nav-text">3 索引</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-sql优化"><span class="nav-number">4.</span> <span class="nav-text">4 sql优化</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder"></span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.1.1</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.1"></script>

  <script src="/js/motion.js?v=7.1.1"></script>



  
  


  <script src="/js/schemes/muse.js?v=7.1.1"></script>



  
  <script src="/js/scrollspy.js?v=7.1.1"></script>
<script src="/js/post-details.js?v=7.1.1"></script>



  


  <script src="/js/next-boot.js?v=7.1.1"></script>


  

  

  

  


  


  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
