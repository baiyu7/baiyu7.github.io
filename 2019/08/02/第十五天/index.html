<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.1.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="1 进程和线程​             12进程:一个在内存中运行的程序,它有自己的独立内存空间线程:存在进程中,是一个进程中的一条执行线索,同一个进行中可以有一个或者多个线程,线程是可以并发运行 ​         2 用 Thread类创建线程​         1) 设计一个类,用来继承Thread类 ,此类是java.lang下的         2) 重写里面的run()方法">
<meta property="og:type" content="article">
<meta property="og:title" content="java多线程">
<meta property="og:url" content="http://yoursite.com/2019/08/02/第十五天/index.html">
<meta property="og:site_name" content="生活不止眼前的苟且，还有诗和远方。">
<meta property="og:description" content="1 进程和线程​             12进程:一个在内存中运行的程序,它有自己的独立内存空间线程:存在进程中,是一个进程中的一条执行线索,同一个进行中可以有一个或者多个线程,线程是可以并发运行 ​         2 用 Thread类创建线程​         1) 设计一个类,用来继承Thread类 ,此类是java.lang下的         2) 重写里面的run()方法">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-08-04T04:47:17.377Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="java多线程">
<meta name="twitter:description" content="1 进程和线程​             12进程:一个在内存中运行的程序,它有自己的独立内存空间线程:存在进程中,是一个进程中的一条执行线索,同一个进行中可以有一个或者多个线程,线程是可以并发运行 ​         2 用 Thread类创建线程​         1) 设计一个类,用来继承Thread类 ,此类是java.lang下的         2) 重写里面的run()方法">





  
  
  <link rel="canonical" href="http://yoursite.com/2019/08/02/第十五天/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>java多线程 | 生活不止眼前的苟且，还有诗和远方。</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">


<div class="bg_content">
  <canvas id="canvas"></canvas>
</div>



  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
<a href="https://github.com/baiyu7?tab=repositories" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">生活不止眼前的苟且，还有诗和远方。</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/02/第十五天/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content>
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="生活不止眼前的苟且，还有诗和远方。">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">java多线程

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-08-02 19:14:06" itemprop="dateCreated datePublished" datetime="2019-08-02T19:14:06+08:00">2019-08-02</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-08-04 12:47:17" itemprop="dateModified" datetime="2019-08-04T12:47:17+08:00">2019-08-04</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/java基础/" itemprop="url" rel="index"><span itemprop="name">java基础</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="1-进程和线程"><a href="#1-进程和线程" class="headerlink" title="1 进程和线程"></a>1 进程和线程</h1><p>​            </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">进程:一个在内存中运行的程序,它有自己的独立内存空间</span><br><span class="line">线程:存在进程中,是一个进程中的一条执行线索,同一个进行中可以有一个或者多个线程,线程是可以并发运行</span><br></pre></td></tr></table></figure>
<p>​        </p>
<h1 id="2-用-Thread类创建线程"><a href="#2-用-Thread类创建线程" class="headerlink" title="2 用 Thread类创建线程"></a>2 用 Thread类创建线程</h1><p>​         1) 设计一个类,用来继承Thread类 ,此类是java.lang下的<br>         2) 重写里面的run()方法<br>         3) 创建这个类的对象,就是线程对象<br>         4) 调用start()方法启动当前线程,start方法有两层含义,一层是启动线程,一层是调用线程中的run方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		格挡 gd=<span class="keyword">new</span> 格挡();</span><br><span class="line">		gd.start();</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">50</span>;i++)&#123;</span><br><span class="line">			Thread.sleep(<span class="number">5</span>);<span class="comment">//目的是让主线程执行到此位置,睡眠1毫秒,此时要释放cup</span></span><br><span class="line">			System.out.println(<span class="string">"--&gt;  --&gt;  --&gt;"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">			&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> 格挡 <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">50</span>;i++)&#123;</span><br><span class="line">			<span class="comment">//此位置不能声明抛异常,原因是run方法父类没有抛,子类不允许</span></span><br><span class="line">			<span class="keyword">try</span> &#123;Thread.sleep(<span class="number">1</span>);&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;e.printStackTrace();&#125;<span class="comment">//目的是让子线程执行到此位置,睡眠1毫秒,此时要释放cup</span></span><br><span class="line">			System.out.println(<span class="string">"--&gt;(  --&gt;(  --&gt;("</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//例子 线程的简单实例</span></span><br><span class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">			MyThread t=<span class="keyword">new</span> MyThread();</span><br><span class="line">			t.start();</span><br><span class="line">			Thread.sleep(<span class="number">100</span>);</span><br><span class="line">			<span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">				Thread.currentThread().setName(<span class="string">"B"</span>);<span class="comment">//设置名字  Thread.currentThread()是得到当前线程</span></span><br><span class="line">				System.out.println(Thread.currentThread().getName()+<span class="string">"--我是主线程"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					Thread.sleep(<span class="number">1</span>);</span><br><span class="line">				&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">				setName(<span class="string">"A"</span>);</span><br><span class="line">				System.out.println(getName()+<span class="string">"--我是多线程"</span>);<span class="comment">//setName("A")和getName()是Thread类继承过来的</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"><span class="comment">//例子 需求:启动6个线程,5个子线程,一个主线程</span></span><br><span class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">			MyThread t=<span class="keyword">new</span> MyThread();</span><br><span class="line">			t.start();</span><br><span class="line">			t.start();</span><br><span class="line">			t.start();</span><br><span class="line">			t.start();</span><br><span class="line">			t.start();</span><br><span class="line">			<span class="comment">//不可以这样启动多个线程,会抛异常java.lang.IllegalThreadStateException  线程状态非法异常</span></span><br><span class="line">			<span class="comment">//不可以让一个线程start多次,</span></span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			System.out.println(<span class="string">"我是子线程"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	修改</span><br><span class="line">		<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">				MyThread t1=<span class="keyword">new</span> MyThread(<span class="string">"线程1"</span>);</span><br><span class="line">				MyThread t2=<span class="keyword">new</span> MyThread(<span class="string">"线程2"</span>);</span><br><span class="line">				MyThread t3=<span class="keyword">new</span> MyThread(<span class="string">"线程3"</span>);</span><br><span class="line">				MyThread t4=<span class="keyword">new</span> MyThread(<span class="string">"线程4"</span>);</span><br><span class="line">				MyThread t5=<span class="keyword">new</span> MyThread(<span class="string">"线程5"</span>);</span><br><span class="line">				t1.start();</span><br><span class="line">				t2.start();</span><br><span class="line">				t3.start();</span><br><span class="line">				t4.start();</span><br><span class="line">				t5.start();</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">			<span class="comment">//private String name;</span></span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="title">MyThread</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">				<span class="comment">//setName(name);</span></span><br><span class="line">				<span class="comment">//this.name=name;</span></span><br><span class="line">				<span class="keyword">super</span>(name);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">				System.out.println(getName()+<span class="string">"--我是子线程"</span>);</span><br><span class="line">				<span class="comment">//System.out.println(name+"--我是子线程");</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>
<h1 id="3-线程的状态"><a href="#3-线程的状态" class="headerlink" title="3 线程的状态"></a>3 线程的状态</h1><p>​        </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">	线程从创建、运行到结束总是处于下面五个状态之一：新建状态、就绪状态、运行状态、阻塞状态及死亡状态。</span><br><span class="line">	新建状态----&gt; 就绪状态</span><br><span class="line">				 /		\</span><br><span class="line">				/		 \</span><br><span class="line">			   阻塞&lt;---运行状态---&gt;死亡状态</span><br><span class="line">			   </span><br><span class="line"><span class="number">1</span>.新建状态(New)： </span><br><span class="line">    当用<span class="keyword">new</span>操作符创建一个线程时， 例如<span class="keyword">new</span> MyThread(<span class="string">"我是线程"</span>);线程还没有开始运行，此时线程处在新建状态。</span><br><span class="line"></span><br><span class="line"> <span class="number">2</span>.就绪状态(Runnable)</span><br><span class="line"></span><br><span class="line">    一个新创建的线程并不自动开始运行，要执行线程，必须调用线程的start()方法。</span><br><span class="line">	当线程对象调用start()方法即启动了线程，start()方法创建线程运行的系统资源，并调度线程运行run()方法。</span><br><span class="line">    处于就绪状态的线程并不一定立即运行run()方法，线程还必须同其他线程竞争CPU时间，只有获得CPU时间才可以运行线程。</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.运行状态(Running)</span><br><span class="line"></span><br><span class="line">    当线程获得CPU时间后，它才进入运行状态，真正开始执行run()方法.</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>.阻塞状态(Blocked)</span><br><span class="line">	所谓阻塞状态是正在运行的线程没有运行结束，暂时让出CPU，这时其他处于就绪状态的线程就可以获得CPU时间，进入运行状态。</span><br><span class="line">	如果一个线程执行了sleep（睡眠）、suspend（挂起 ）等方法，失去所占用资源之后，</span><br><span class="line">	该线程就从运行状态进入阻塞状态。在睡眠时间已到或获得设备资源后可以重新进入就绪状态。</span><br><span class="line">	</span><br><span class="line">	Scanner scan=<span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">	String str=scan.next();</span><br><span class="line">	</span><br><span class="line">	可以分为三种：</span><br><span class="line">	等待阻塞：运行状态中的线程执行 wait() 方法，使线程进入到等待阻塞状态。</span><br><span class="line">	同步阻塞：线程在获取 <span class="keyword">synchronized</span> 同步锁失败(因为同步锁被其他线程占用)。</span><br><span class="line">	其他阻塞：通过调用线程的 sleep() 或 join()、suspend() 发出了 I/O 请求时，线程就会进入到阻塞状态。</span><br><span class="line">			  当sleep() 状态超时，join() 等待线程终止或超时，或者 I/O 处理完毕，线程重新转入就绪状态。</span><br><span class="line">			  </span><br><span class="line">	其中，sleep()：释放CPU执行权，等待指定时间后自己醒来。不会释放所持有对象的锁。</span><br><span class="line">		  join()：释放CPU执行权，等待被调用join方法的线程结束才继续执行本线程下面的操作。不会释放所持有对象的锁。</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">		  Suspend()用于挂起线程，Resume()用于继续执行已经挂起的线程  !!!!!!!</span><br><span class="line">		  </span><br><span class="line"><span class="number">5</span>.死亡状态(Dead)</span><br><span class="line"></span><br><span class="line">    有以下几个原因会导致线程死亡：</span><br><span class="line">    <span class="number">1</span>) run方法正常退出而自然死亡，</span><br><span class="line">    <span class="number">2</span>) 一个未捕获的异常终止了run方法而使线程猝死。</span><br><span class="line">	<span class="number">3</span>) 调用其 stop() 方法  <span class="comment">//stop过时,不安全,容易引起死锁</span></span><br><span class="line">	</span><br><span class="line">	Suspend():已过时,弃用</span><br><span class="line">	Resume():已过时,弃用</span><br><span class="line">	stop():已过时,弃用</span><br><span class="line">	</span><br><span class="line">	面试题:<span class="number">1</span>.sleep()和wait()区别?</span><br><span class="line">			 sleep()遇到的时候,会放弃cpu的执行权,不会放弃锁,wait()会放弃cpu的执行权,会放弃锁</span><br><span class="line">		   <span class="number">2</span>.sleep()和yield区别?</span><br><span class="line">			 </span><br><span class="line">		 <span class="number">1</span>) sleep是Thread类的一个静态方法，该方法会让当前正在 执行的线程暂停指定的时间，从而将执行机会让给其他线程执行。</span><br><span class="line">			 经过这段阻塞时间后，该线程会进入就绪状态，再次等候cpu的执行</span><br><span class="line">		</span><br><span class="line">		 <span class="number">2</span>) yield方法只会给优先级相同或更高优先级的线程执行机会。yield不会将线程转入阻塞状态，只是强制当前线程进入就绪状态。</span><br><span class="line">			 通俗地说 yield()方法只是把线程的状态由执行状态打回就绪状态，所以有可能直接被再次执行到 </span><br><span class="line">		</span><br><span class="line">			<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">				<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">					MyThread t1=<span class="keyword">new</span> MyThread(<span class="string">"A"</span>);</span><br><span class="line">					MyThread t2=<span class="keyword">new</span> MyThread(<span class="string">"B"</span>);</span><br><span class="line">					t1.start();</span><br><span class="line">					t2.start();</span><br><span class="line">					</span><br><span class="line">				&#125;</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">				<span class="function"><span class="keyword">public</span> <span class="title">MyThread</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">					setName(name);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">					<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">5000</span>;i++)&#123;</span><br><span class="line">						System.out.println(getName()+<span class="string">":子线程运行--&gt;"</span>+i);</span><br><span class="line">						<span class="keyword">if</span>(i==<span class="number">20</span>)&#123;</span><br><span class="line">							Thread.yield();<span class="comment">//你们可以试试,正常情况A线程yield之后,可能又抢到执行权,在继续执行</span></span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		Java 中的线程优先级是在 Thread 类中定义的常量（<span class="number">1</span>-<span class="number">10</span>整数表示）</span><br><span class="line">			NORM_PRIORITY : 值为 <span class="number">5</span>   </span><br><span class="line">			MAX_PRIORITY : 值为 <span class="number">10</span></span><br><span class="line">			MIN_PRIORITY : 值为 <span class="number">1</span></span><br><span class="line">			默认的优先级为 NORM_PRIORITY  </span><br><span class="line">			有关优先级的方法有两个：</span><br><span class="line">			<span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">setPriority</span><span class="params">(<span class="keyword">int</span> newp)</span> : 修改线程的当前优先级</span></span><br><span class="line"><span class="function">			<span class="keyword">final</span> <span class="keyword">int</span> <span class="title">getPriority</span><span class="params">()</span> : 返回线程的优先级</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		MyThread t1=<span class="keyword">new</span> MyThread(<span class="string">"A"</span>);</span><br><span class="line">		MyThread t2=<span class="keyword">new</span> MyThread(<span class="string">"B"</span>);</span><br><span class="line">		t1.start();</span><br><span class="line">		t2.setPriority(<span class="number">1</span>);  <span class="comment">//此时效果就是A一致执行下去,就算遇到yield,也会重新在抢夺上</span></span><br><span class="line">		t2.start();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">MyThread</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">		setName(name);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">5000</span>;i++)&#123;</span><br><span class="line">			System.out.println(getName()+<span class="string">":子线程运行--&gt;"</span>+i);</span><br><span class="line">			<span class="keyword">if</span>(i==<span class="number">20</span>)&#123;</span><br><span class="line">				Thread.yield();<span class="comment">//你们可以试试,正常情况A线程yield之后,可能又抢到执行权,在继续执行</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​            </p>
<h1 id="4-售票程序"><a href="#4-售票程序" class="headerlink" title="4 售票程序"></a>4 售票程序</h1><p>​        </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//需求:比如说哈尔滨5个车站,同时售票买哈尔滨到北京,100张票</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">				MyThread t1=<span class="keyword">new</span> MyThread(<span class="string">"A"</span>);</span><br><span class="line">				MyThread t2=<span class="keyword">new</span> MyThread(<span class="string">"B"</span>);</span><br><span class="line">				MyThread t3=<span class="keyword">new</span> MyThread(<span class="string">"C"</span>);</span><br><span class="line">				MyThread t4=<span class="keyword">new</span> MyThread(<span class="string">"D"</span>);</span><br><span class="line">				MyThread t5=<span class="keyword">new</span> MyThread(<span class="string">"E"</span>);</span><br><span class="line">				t1.start();</span><br><span class="line">				t2.start();</span><br><span class="line">				t3.start();</span><br><span class="line">				t4.start();</span><br><span class="line">				t5.start();</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">			<span class="keyword">static</span> <span class="keyword">int</span> ticket=<span class="number">100</span>;</span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="title">MyThread</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">				setName(name);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">				<span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">					<span class="keyword">if</span>(ticket&gt;<span class="number">0</span>)&#123;</span><br><span class="line">						<span class="keyword">try</span> &#123;</span><br><span class="line">							Thread.sleep(<span class="number">10</span>);</span><br><span class="line">						&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">							e.printStackTrace();</span><br><span class="line">						&#125;</span><br><span class="line">						System.out.println(<span class="string">"车站:"</span>+getName()+<span class="string">"正在卖第"</span>+ticket--+<span class="string">"张"</span>);</span><br><span class="line">					&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">运行发现:会出现负数的情况,原因是因为当一个线程执行进入<span class="keyword">if</span>中时,其他线程也可能进入到<span class="keyword">if</span>中了,然后第一个线程</span><br><span class="line">		 就执行了自减操作,然后其他线程也会执行自减操作,但是此时可能就会存在负数情况</span><br><span class="line">		 </span><br><span class="line">解决:</span><br><span class="line">方案:同步代码块</span><br><span class="line">	<span class="keyword">synchronized</span>(同步对象)&#123;</span><br><span class="line">		需要同步的代码  <span class="comment">//具有原子性</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	同步对象就是java中某个类的对象,每一个对象都有且只有一个同步锁</span><br><span class="line">	持有锁的线程就会进入同步代码块中</span><br><span class="line">	没有持有锁的线程即使获得cpu的执行权,也进不去</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">				MyThread t1=<span class="keyword">new</span> MyThread(<span class="string">"A"</span>);</span><br><span class="line">				MyThread t2=<span class="keyword">new</span> MyThread(<span class="string">"B"</span>);</span><br><span class="line">				MyThread t3=<span class="keyword">new</span> MyThread(<span class="string">"C"</span>);</span><br><span class="line">				MyThread t4=<span class="keyword">new</span> MyThread(<span class="string">"D"</span>);</span><br><span class="line">				MyThread t5=<span class="keyword">new</span> MyThread(<span class="string">"E"</span>);</span><br><span class="line">				t1.start();</span><br><span class="line">				t2.start();</span><br><span class="line">				t3.start();</span><br><span class="line">				t4.start();</span><br><span class="line">				t5.start();</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">			<span class="keyword">static</span> <span class="keyword">int</span> ticket=<span class="number">100</span>;</span><br><span class="line">			<span class="keyword">static</span> Object obj=<span class="keyword">new</span> Object();</span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="title">MyThread</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">				setName(name);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">				<span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">					<span class="keyword">synchronized</span> (obj) &#123;</span><br><span class="line">						<span class="keyword">if</span>(ticket&gt;<span class="number">0</span>)&#123;</span><br><span class="line">							<span class="keyword">try</span> &#123;</span><br><span class="line">								Thread.sleep(<span class="number">10</span>);</span><br><span class="line">							&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">								e.printStackTrace();</span><br><span class="line">							&#125;</span><br><span class="line">							System.out.println(<span class="string">"车站:"</span>+getName()+<span class="string">"正在卖第"</span>+ticket--+<span class="string">"张"</span>);</span><br><span class="line">						&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">说明:</span><br><span class="line">一段同步代码被一个线程执行之前,他要拿到执行这段程序的权限</span><br><span class="line">而此时obj就是这个权限,也就是同步对象的锁</span><br><span class="line">大家都会抢夺同步对象的锁,当一个线程抢夺之后拥有这个对象的锁后</span><br><span class="line">就会进入同步代码块中,而其他线程只能在锁池中进行等待</span><br><span class="line">线程之后完同步代码块之后,马上就把锁还给同步对象</span><br><span class="line">其他线程就有机会再次抢夺,进行而执行</span><br></pre></td></tr></table></figure>
<p>​            </p>
<h1 id="5-使用Runable接口实现多线程-做常用的方式"><a href="#5-使用Runable接口实现多线程-做常用的方式" class="headerlink" title="5 使用Runable接口实现多线程  (做常用的方式)"></a>5 使用Runable接口实现多线程  (做常用的方式)</h1><p>​        </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Thread类也实现了Runable接口</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">			MyThread_01 t01=<span class="keyword">new</span> MyThread_01();</span><br><span class="line">			Thread t=<span class="keyword">new</span> Thread(t01);  <span class="comment">//注意启动方式</span></span><br><span class="line">			t.start();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">MyThread_01</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			System.out.println(<span class="string">"---------------------"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//把售票程序进行改动</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">			MyThread my=<span class="keyword">new</span> MyThread();</span><br><span class="line">			<span class="keyword">new</span> Thread(my).start();</span><br><span class="line">			<span class="keyword">new</span> Thread(my).start();</span><br><span class="line">			<span class="keyword">new</span> Thread(my).start();</span><br><span class="line">			<span class="keyword">new</span> Thread(my).start();</span><br><span class="line">			<span class="keyword">new</span> Thread(my).start();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">		<span class="keyword">static</span> <span class="keyword">int</span> ticket=<span class="number">100</span>;</span><br><span class="line">		<span class="keyword">static</span> Object obj=<span class="keyword">new</span> Object();</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">				<span class="keyword">synchronized</span> (obj) &#123;</span><br><span class="line">					<span class="keyword">if</span>(ticket&gt;<span class="number">0</span>)&#123;</span><br><span class="line">						<span class="keyword">try</span> &#123;</span><br><span class="line">							Thread.sleep(<span class="number">10</span>);</span><br><span class="line">						&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">							e.printStackTrace();</span><br><span class="line">						&#125;</span><br><span class="line">						System.out.println(<span class="string">"车站正在卖第"</span>+ticket--+<span class="string">"张"</span>);</span><br><span class="line">					&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">====同步函数</span><br><span class="line">		<span class="keyword">synchronized</span> (obj) &#123;</span><br><span class="line">			<span class="keyword">if</span>(ticket&gt;<span class="number">0</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					Thread.sleep(<span class="number">10</span>);</span><br><span class="line">				&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">				System.out.println(<span class="string">"车站正在卖第"</span>+ticket--+<span class="string">"张"</span>);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	修改成</span><br><span class="line">	</span><br><span class="line">		<span class="comment">//售票</span></span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">sale</span><span class="params">()</span></span>&#123;</span><br><span class="line">				<span class="keyword">if</span>(ticket&gt;<span class="number">0</span>)&#123;</span><br><span class="line">					<span class="keyword">try</span> &#123;</span><br><span class="line">						Thread.sleep(<span class="number">10</span>);</span><br><span class="line">					&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">						e.printStackTrace();</span><br><span class="line">					&#125;</span><br><span class="line">					System.out.println(<span class="string">"车站正在卖第"</span>+ticket--+<span class="string">"张"</span>);</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					System.exit(<span class="number">0</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">	  同步函数使用的锁   是   <span class="keyword">this</span>对象</span><br><span class="line">	  同步静态函数使用的锁   是 类名.class</span><br><span class="line">	  </span><br><span class="line">	  <span class="comment">//例子 如果让下面的同步函数和同步代码块同步,锁应该怎么写? this</span></span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">SaleThrad</span></span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">sale</span><span class="params">()</span></span>&#123;</span><br><span class="line">			<span class="keyword">synchronized</span>(<span class="keyword">this</span>)&#123;</span><br><span class="line">			</span><br><span class="line">		   &#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//例子 如果让下面的同步静态函数和同步代码块同步,锁应该怎么写? SaleThrad.class</span></span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">SaleThrad</span></span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="function"><span class="keyword">synchronized</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sale</span><span class="params">()</span></span>&#123;</span><br><span class="line">			<span class="keyword">synchronized</span>(SaleThrad.class)&#123;</span><br><span class="line">			</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">总结:</span><br><span class="line">	使用Thread和Runnbale有什么区别?</span><br><span class="line">	<span class="number">1</span>)可以避免java中不支持多继承的问题</span><br><span class="line">	<span class="number">2</span>)使用后者,更容易实现多个线程的数据共享(前者属于多个任务,各做各的,后者属于,一个任务,多个人分,而且其中任务中的数据是可以共享的)</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">面试</span><br><span class="line">	holdsLock() 方法。</span><br><span class="line">	检测一个线程是否拥有锁，是java.lang.Thread类中的，它返回<span class="keyword">true</span>表示拥有某个具体对象的锁</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">		<span class="keyword">public</span> <span class="keyword">static</span> Object obj=<span class="keyword">new</span> Object();</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">			<span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable()&#123;</span><br><span class="line">				<span class="meta">@Override</span></span><br><span class="line">				<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">					System.out.println(<span class="string">"子线程:"</span>+Thread.holdsLock(obj));</span><br><span class="line">					<span class="keyword">synchronized</span> (obj) &#123;</span><br><span class="line">						System.out.println(<span class="string">"子线程执行同步代码块"</span>+Thread.holdsLock(obj));</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;).start();</span><br><span class="line">			System.out.println(<span class="string">"主线程:"</span>+Thread.holdsLock(obj));</span><br><span class="line">			<span class="keyword">synchronized</span> (obj) &#123;</span><br><span class="line">				System.out.println(<span class="string">"主线程执行同步代码块"</span>+Thread.holdsLock(obj));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	主线程:<span class="keyword">false</span></span><br><span class="line">	主线程执行同步代码块<span class="keyword">true</span></span><br><span class="line">	子线程:<span class="keyword">false</span></span><br><span class="line">	子线程执行同步代码块<span class="keyword">true</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//可以观察到,当拿到同步锁,就是true,没拿到就是flase</span></span><br></pre></td></tr></table></figure>
<h1 id="6-实现线程的另外两种方式"><a href="#6-实现线程的另外两种方式" class="headerlink" title="6 实现线程的另外两种方式"></a>6 实现线程的另外两种方式</h1><p>​        </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">==实现Callable接口通过FutureTask包装器来创建Thread线程	</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">			TestCallable tc=<span class="keyword">new</span> TestCallable();</span><br><span class="line">			</span><br><span class="line">			FutureTask&lt;Integer&gt; result=<span class="keyword">new</span> FutureTask&lt;Integer&gt;(tc);</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++)&#123;</span><br><span class="line">				System.out.println(Thread.currentThread().getName()+<span class="string">"--&gt;"</span>+i);</span><br><span class="line">				<span class="keyword">if</span>(i==<span class="number">30</span>)&#123;</span><br><span class="line">					Thread t=<span class="keyword">new</span> Thread(result);</span><br><span class="line">					t.start();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			System.out.println(<span class="string">"主线程的for循环完毕"</span>);</span><br><span class="line">			<span class="comment">//接受返回值</span></span><br><span class="line">			Integer r=result.get();<span class="comment">//当子线程的call方法没有运行完毕,将会阻塞,直到返回值为止</span></span><br><span class="line">			System.out.println(r);</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">TestCallable</span> <span class="keyword">implements</span> <span class="title">Callable</span>&lt;<span class="title">Integer</span>&gt;</span>&#123;</span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> Integer <span class="title">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">			<span class="keyword">int</span> sum=<span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++)&#123;</span><br><span class="line">				System.out.println(Thread.currentThread().getName()+<span class="string">"--&gt;"</span>+i);</span><br><span class="line">				sum+=i;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> sum;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">使用线程池的方式</span><br><span class="line">		</span><br><span class="line">		 线程池的好处:</span><br><span class="line">			假设一个服务器完成一项任务所需时间为</span><br><span class="line">			T1 创建线程</span><br><span class="line">			T2 使用线程</span><br><span class="line">			T3 销毁线程</span><br><span class="line">			如果T1+T3远远大于T2,则可以采用线程池,以提高服务器的性能</span><br><span class="line">			</span><br><span class="line">		<span class="number">1</span>、创建线程池接口ExecutorService  </span><br><span class="line">		其中Executor是顶层接口，里面只声明一个方法，ExecutorService继承它</span><br><span class="line">		Java提供四种常用的线程池，分别为：</span><br><span class="line">		newCachedThreadPool创建一个可缓存线程池，如果线程池长度超过处理需要，可灵活回收空闲线程，若无可回收，则新建线程。</span><br><span class="line">		newFixedThreadPool 创建一个定长线程池，可控制线程最大并发数，超出的线程会在队列中等待。</span><br><span class="line">		newScheduledThreadPool 创建一个定长线程池，支持定时及周期性任务执行。</span><br><span class="line">		newSingleThreadExecutor 创建一个单线程化的线程池，它只会用唯一的工作线程来执行任务，保证所有任务按照指定顺序(FIFO, LIFO, 优先级)执行。	</span><br><span class="line">								FIFO:First in First out  先进先出</span><br><span class="line">								LIFO:last in First out 后进先出</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">可以通过工具类java.util.concurrent.Executors的静态方法来创建以上线程。</span><br><span class="line">	　　Executors实际上是一个线程池的管理工具：</span><br><span class="line">　　ExecutorService executorService = Executors.newCachedThreadPool();</span><br><span class="line">　　ExecutorService executorService = Executors.newFixedThreadPool(<span class="number">3</span>);</span><br><span class="line">	ExecutorService executorService = Executors.newScheduledThreadPool(<span class="number">3</span>);</span><br><span class="line">　　ExecutorService executorService = Executors.newSingleThreadExecutor();	</span><br><span class="line"></span><br><span class="line">  <span class="number">2</span>、将任务添加到线程去执行</span><br><span class="line">	　　当将一个任务添加到线程池中的时候，线程池会为每个任务创建一个线程，该线程会在之后的某个时刻自动执行。</span><br><span class="line">任务分两类：</span><br><span class="line">一类是实现了Runnable接口的类，</span><br><span class="line">一类是实现了Callable接口的类。</span><br><span class="line">两者都可以被ExecutorService执行，</span><br><span class="line">但是 Runnable任务没有返回值，</span><br><span class="line">而Callable任务有返回值。</span><br><span class="line">并且Callable的任务只能通过ExecutorService的 submit（）方法来执行，</span><br></pre></td></tr></table></figure>
<p>​<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//例子 实现了Callable接口的类。</span></span><br><span class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">			ExecutorService executorService = Executors.newCachedThreadPool();</span><br><span class="line">			List&lt;Future&lt;String&gt;&gt; list=<span class="keyword">new</span> ArrayList&lt;Future&lt;String&gt;&gt;();</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">				list.add(executorService.submit(<span class="keyword">new</span> TestCallable(i)));</span><br><span class="line">			&#125;</span><br><span class="line">			executorService.shutdown();<span class="comment">//线程池拒绝接受新提交的任务,同时等待线程池中的任务等执行完毕.才会关闭线程池</span></span><br><span class="line">			<span class="comment">//executorService.shutdownNow();//线程池拒绝接受新提交的任务,会立刻关闭,就算有任务没执行完,也会停止执行</span></span><br><span class="line">			<span class="keyword">for</span>(Future&lt;String&gt; f:list)&#123;</span><br><span class="line">				System.out.println(f.get());</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">TestCallable</span> <span class="keyword">implements</span> <span class="title">Callable</span>&lt;<span class="title">String</span>&gt;</span>&#123;</span><br><span class="line">		<span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="title">TestCallable</span><span class="params">(<span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.id=id;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> String <span class="title">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">"TestCallable:"</span>+id;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实现了Runnable接口的类，</span></span><br><span class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">			ExecutorService executorService = Executors.newCachedThreadPool();</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">				executorService.submit(<span class="keyword">new</span> TestRunnable(i));</span><br><span class="line">			&#125;</span><br><span class="line">			executorService.shutdown();<span class="comment">//线程池拒绝接受新提交的任务,同时等待线程池中的任务等执行完毕.才会关闭线程池</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">TestRunnable</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">		<span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="title">TestRunnable</span><span class="params">(<span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.id=id;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			System.out.println(<span class="string">"TestRunnable:"</span>+id);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">也可以用execute执行,返回为<span class="keyword">void</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		ExecutorService executorService = Executors.newCachedThreadPool();</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">			executorService.execute(<span class="keyword">new</span> TestRunnable(i));</span><br><span class="line">		&#125;</span><br><span class="line">		executorService.shutdown();<span class="comment">//线程池拒绝接受新提交的任务,同时等待线程池中的任务等执行完毕.才会关闭线程池</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestRunnable</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">TestRunnable</span><span class="params">(<span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id=id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"TestRunnable:"</span>+id);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">区别:execute和submit区别</span><br><span class="line">使用submit可以直到线程执行是否成功</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		ExecutorService executorService = Executors.newCachedThreadPool();</span><br><span class="line">		Future r=executorService.submit(<span class="keyword">new</span> TestRunnable(<span class="number">0</span>));</span><br><span class="line">		executorService.shutdown();<span class="comment">//线程池拒绝接受新提交的任务,同时等待线程池中的任务等执行完毕.才会关闭线程池</span></span><br><span class="line">		<span class="keyword">try</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(r.get()==<span class="keyword">null</span>)&#123;</span><br><span class="line">				System.out.println(<span class="string">"线程执行成功"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			System.out.println(<span class="string">"线程执行失败"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">TestRunnable</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">		<span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="title">TestRunnable</span><span class="params">(<span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.id=id;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">int</span> a=<span class="number">90</span>/id;</span><br><span class="line">			System.out.println(<span class="string">"TestRunnable:"</span>+id);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	当线程执行成功时,使用submit()方法会返回<span class="keyword">null</span></span><br><span class="line">	否则就是执行失败,</span><br></pre></td></tr></table></figure>
<p>​<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">总结：</span><br><span class="line">Java多线程实现方式主要有四种：</span><br><span class="line"><span class="number">1</span>.继承Thread类、</span><br><span class="line"><span class="number">2</span>.实现Runnable接口、</span><br><span class="line"><span class="number">3</span>.实现Callable接口通过FutureTask包装器来创建多线程、</span><br><span class="line"><span class="number">4</span>.使用线程池完成多线程。</span><br><span class="line">其中前两种方式线程执行完后都没有返回值</span><br><span class="line">第三种，带返回值</span><br><span class="line">第四种使用线程池运行可以添加两种类型任务，</span><br><span class="line">一种是实现了Runnable接口的类，一种是实现了Callable接口的类。</span><br><span class="line">前者使用execute无返回值，使用submit有返回值（<span class="keyword">null</span>或异常）</span><br><span class="line">后者只可以使用submit运行，有返回值</span><br></pre></td></tr></table></figure></p>
<p>面试题        </p>
<p>​            </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. Java中Runnable和Callable有什么不同？</span><br><span class="line">   Runnable从<span class="number">1.0</span>出现的,Callable是从<span class="number">1.5</span>出现的</span><br><span class="line">   它们的主要区别,call方法具备返回值,而且可以声明抛出异常</span><br><span class="line">   而run是不具备返回值的,并且不可以声明抛出异常,只能<span class="keyword">try</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.Java中的<span class="keyword">volatile</span> 变量是什么？</span><br><span class="line"><span class="keyword">volatile</span>是一个特殊的修饰符，只有成员变量才能使用它.</span><br><span class="line">多线程对成员变量的操作对其它线程是透明的。</span><br><span class="line"><span class="keyword">volatile</span>变量可以保证下一个读取操作会在前一个写操作之后发生（即写操作会发生在后续的读操作之前）</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.Java多线程<span class="keyword">volatile</span>和<span class="keyword">synchronized</span>区别</span><br><span class="line"><span class="keyword">volatile</span>是轻量级的<span class="keyword">synchronized</span>，在多线程开发中保证了共享变量的“可见性”。</span><br><span class="line">可见性表示当一个线程修改了一个共享变量时，另外一个线程能读到这个修改的值。（即写操作会发生在后续的读操作之前）</span><br><span class="line">因为使用其修饰的变量会强制将修改的值写入主存。所以读的时候就保证了准确性</span><br><span class="line">synchionized是java中的关键字，<span class="keyword">synchronized</span>是内置语言实现的。可以同步一段代码</span><br></pre></td></tr></table></figure>
<pre><code>为什么?
        volatile只能保证可见性,但是不能保证变量的原子性
        ticket-- 并不是原子操作,会执行三个步骤
        1.从内存中读取ticket值
        2.减1
        3.把修改后的值刷新到内存中
        而volatile不能保证上面三步骤的原子性,所以ticket--操作还是会受到影响,故线程还是不安全的
</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span>.如何保证多线程下 i++ 结果正确？</span><br><span class="line">	因为i++并不是原子性操作,所以多线程无法保证它的准确性,故需要使用同步来完成</span><br><span class="line">	</span><br><span class="line"><span class="number">5</span>.start() 和 run() 方法有什么区别	</span><br><span class="line">	start（）方法来启动线程，真正实现了多线程运行</span><br><span class="line">	run（）方法当作普通方法的方式调用。程序还是要顺序执行</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"><span class="number">6</span>.能不能自己写个类叫java.lang.Object</span><br><span class="line">	不能,因为java有双亲委派原则</span><br><span class="line">		</span><br><span class="line">类加载器</span><br><span class="line">	</span><br><span class="line">	启动类加载器     (JAVA_HOME/jre/lib   包)</span><br><span class="line">	Bootstrap ClassLoade</span><br><span class="line">		^</span><br><span class="line">		|</span><br><span class="line">	扩展类加载器     (JAVA_HOME/jre/lib/ext  包)</span><br><span class="line">	Extension ClassLoader</span><br><span class="line">		^</span><br><span class="line">		|</span><br><span class="line">	应用程序类加载器  (我们自己写的类,已经自己放入的jar包)</span><br><span class="line">	Application ClassLoader </span><br><span class="line">		^</span><br><span class="line">		|</span><br><span class="line">	自定义类加载器 （继承java.lang.ClassLoader）</span><br><span class="line">	Custom ClassLoader</span><br><span class="line">	   .............</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">工作过程：如果一个类加载器接收到了类加载的请求，它首先把这个请求委托给他的父类加载器去完成，</span><br><span class="line">		  每个层次的类加载器都是如此，因此所有的加载请求都应该传送到顶层的启动类加载器中，</span><br><span class="line">		  只有当父加载器反馈自己无法完成这个加载请求时，子加载器才会尝试自己去加载。</span><br><span class="line">		  </span><br><span class="line">好处：避免重复加载+避免核心类篡改</span><br><span class="line"></span><br><span class="line">	  采用双亲委派的一个好处是比如加载位于rt.jar包中的类java.lang.Object，</span><br><span class="line">	  不管是哪个加载器加载这个类，最终都是委托给顶层的启动类加载器进行加载，</span><br><span class="line">	  只有当父类加载器反馈自己没法完成加载要求时，子类加载器才会尝试自己去加载。</span><br><span class="line">	  这样就保证了使用不同的类加载器最终得到的都是同样一个Object对象。</span><br><span class="line">	  避免了类的重复加载，而且当我们模拟Object类时，也不会被加载，因为此类</span><br><span class="line">	  已经被加载了，也就同时避免核心类篡改</span><br></pre></td></tr></table></figure>
<h1 id="7-死锁"><a href="#7-死锁" class="headerlink" title="7 死锁"></a>7 死锁</h1><p>​            </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">死锁:两个线程互相等待彼此释放锁的过程就是死锁,</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">			DeadLockThread d1=<span class="keyword">new</span> DeadLockThread(<span class="number">1</span>);</span><br><span class="line">			Thread t1=<span class="keyword">new</span> Thread(d1);</span><br><span class="line">			t1.start();</span><br><span class="line">           d1.flag=<span class="keyword">false</span>;</span><br><span class="line">			</span><br><span class="line">			DeadLockThread d2=<span class="keyword">new</span> DeadLockThread(<span class="number">2</span>);</span><br><span class="line">			Thread t2=<span class="keyword">new</span> Thread(d2);</span><br><span class="line">			t2.start();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">DeadLockThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">		<span class="keyword">public</span> <span class="keyword">boolean</span> flag=<span class="keyword">true</span>;</span><br><span class="line">		<span class="keyword">public</span> <span class="keyword">static</span> Object obj1=<span class="keyword">new</span> Object();</span><br><span class="line">		<span class="keyword">public</span> <span class="keyword">static</span> Object obj2=<span class="keyword">new</span> Object();</span><br><span class="line">		<span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="title">DeadLockThread</span><span class="params">(<span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.id=id;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">				<span class="keyword">if</span>(flag)&#123;</span><br><span class="line">					<span class="keyword">synchronized</span> (obj1) &#123;</span><br><span class="line">						System.out.println(id+<span class="string">":这是if中的obj1锁"</span>);</span><br><span class="line">						<span class="keyword">synchronized</span> (obj2) &#123;</span><br><span class="line">							System.out.println(id+<span class="string">":这是if中的obj2锁"</span>);</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					<span class="keyword">synchronized</span> (obj2) &#123;</span><br><span class="line">						System.out.println(id+<span class="string">":这是else中的obj2锁"</span>);</span><br><span class="line">						<span class="keyword">synchronized</span> (obj1) &#123;</span><br><span class="line">							System.out.println(id+<span class="string">":这是else中的obj1锁"</span>);</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h1 id="8-生产者消费者的问题"><a href="#8-生产者消费者的问题" class="headerlink" title="8 生产者消费者的问题"></a>8 生产者消费者的问题</h1><p>​        </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">				平台 pt=<span class="keyword">new</span> 平台();</span><br><span class="line">				<span class="keyword">new</span> Thread(<span class="keyword">new</span> 生产者(pt)).start();</span><br><span class="line">				<span class="keyword">new</span> Thread(<span class="keyword">new</span> 消费者(pt)).start();</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="class"><span class="keyword">class</span> 平台</span>&#123;</span><br><span class="line">			String name;  <span class="comment">//鸡蛋 核桃</span></span><br><span class="line">			String tool;  <span class="comment">//平底锅 锤子</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="class"><span class="keyword">class</span> 生产者 <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">			<span class="keyword">public</span> 生产者(平台 pt)&#123;</span><br><span class="line">				<span class="keyword">this</span>.pt=pt;</span><br><span class="line">			&#125;</span><br><span class="line">			平台 pt;</span><br><span class="line">			<span class="meta">@Override</span></span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">				<span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">				<span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">					<span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">0</span>)&#123;</span><br><span class="line">						pt.name=<span class="string">"鸡蛋"</span>;</span><br><span class="line">						<span class="keyword">try</span> &#123;Thread.sleep(<span class="number">10</span>);&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;&#125;</span><br><span class="line">						pt.tool=<span class="string">"平底锅"</span>;</span><br><span class="line">					&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">						pt.name=<span class="string">"核桃"</span>;</span><br><span class="line">						<span class="keyword">try</span> &#123;Thread.sleep(<span class="number">10</span>);&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;&#125;</span><br><span class="line">						pt.tool=<span class="string">"锤子"</span>;</span><br><span class="line">					&#125;</span><br><span class="line">					i=(i+<span class="number">1</span>)%<span class="number">2</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="class"><span class="keyword">class</span> 消费者 <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">			<span class="keyword">public</span> 消费者(平台 pt)&#123;</span><br><span class="line">				<span class="keyword">this</span>.pt=pt;</span><br><span class="line">			&#125;</span><br><span class="line">			平台 pt;</span><br><span class="line">			<span class="meta">@Override</span></span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">				<span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">					System.out.print(pt.name);</span><br><span class="line">					<span class="keyword">try</span> &#123;Thread.sleep(<span class="number">10</span>);&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;&#125;</span><br><span class="line">					System.out.println(<span class="string">"--"</span>+pt.tool);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">会出现 不成对匹配的情况</span><br><span class="line">	核桃--平底锅</span><br><span class="line">	鸡蛋--锤子</span><br><span class="line">	核桃--平底锅</span><br><span class="line">	鸡蛋--锤子</span><br><span class="line">	核桃--平底锅</span><br><span class="line">	鸡蛋--锤子</span><br><span class="line">	核桃--平底锅</span><br><span class="line">	鸡蛋--锤子</span><br><span class="line">	</span><br><span class="line">为了让他们能正常匹配的出现,需要同步代码</span><br><span class="line"></span><br><span class="line">生产者改进</span><br><span class="line">	<span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">		<span class="keyword">synchronized</span> (pt) &#123;</span><br><span class="line">			<span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">0</span>)&#123;</span><br><span class="line">				pt.name=<span class="string">"鸡蛋"</span>;</span><br><span class="line">				<span class="keyword">try</span> &#123;Thread.sleep(<span class="number">10</span>);&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;&#125;</span><br><span class="line">				pt.tool=<span class="string">"平底锅"</span>;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				pt.name=<span class="string">"核桃"</span>;</span><br><span class="line">				<span class="keyword">try</span> &#123;Thread.sleep(<span class="number">10</span>);&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;&#125;</span><br><span class="line">				pt.tool=<span class="string">"锤子"</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			i=(i+<span class="number">1</span>)%<span class="number">2</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">消费者改进</span><br><span class="line">	<span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">		<span class="keyword">synchronized</span> (pt) &#123;</span><br><span class="line">			System.out.print(pt.name);</span><br><span class="line">			<span class="keyword">try</span> &#123;Thread.sleep(<span class="number">10</span>);&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;&#125;</span><br><span class="line">			System.out.println(<span class="string">"--"</span>+pt.tool);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">核桃--锤子</span><br><span class="line">核桃--锤子</span><br><span class="line">鸡蛋--平底锅</span><br><span class="line">鸡蛋--平底锅</span><br><span class="line"></span><br><span class="line">消费者消费太快,或者是生产者生产太快</span><br></pre></td></tr></table></figure>
<h1 id="9-线程间的通信"><a href="#9-线程间的通信" class="headerlink" title="9 线程间的通信"></a>9 线程间的通信</h1><p>​        </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">--wait()   告诉当前线程放弃锁(对象同步锁),进行等待,直到接收到在这个锁上的notify通知时继续 </span><br><span class="line">--notify() 通知等待锁的线程,开始运行</span><br><span class="line">--notifyAll 通知等待锁的所有线程,开始运行</span><br><span class="line"></span><br><span class="line">这三个方法来自于Object类</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">			平台 pt=<span class="keyword">new</span> 平台();</span><br><span class="line">			Thread t1=<span class="keyword">new</span> Thread(<span class="keyword">new</span> 生产者(pt));</span><br><span class="line">			Thread t2=<span class="keyword">new</span> Thread(<span class="keyword">new</span> 消费者(pt));</span><br><span class="line">			t1.start();</span><br><span class="line">			t2.start();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="class"><span class="keyword">class</span> 平台</span>&#123;</span><br><span class="line">		String name;  <span class="comment">//鸡蛋 核桃</span></span><br><span class="line">		String tool;  <span class="comment">//平底锅 锤子</span></span><br><span class="line">		<span class="keyword">boolean</span> 有东西=<span class="keyword">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="class"><span class="keyword">class</span> 生产者 <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">		<span class="keyword">public</span> 生产者(平台 pt)&#123;</span><br><span class="line">			<span class="keyword">this</span>.pt=pt;</span><br><span class="line">		&#125;</span><br><span class="line">		平台 pt;</span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">			<span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">				<span class="keyword">synchronized</span> (pt) &#123;</span><br><span class="line">					<span class="keyword">if</span>(pt.有东西==<span class="keyword">true</span>)&#123;</span><br><span class="line">						<span class="keyword">try</span> &#123;</span><br><span class="line">							pt.wait(); <span class="comment">//等待,并释放锁</span></span><br><span class="line">						&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">							e.printStackTrace();</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">0</span>)&#123;</span><br><span class="line">						pt.name=<span class="string">"鸡蛋"</span>;</span><br><span class="line">						<span class="keyword">try</span> &#123;Thread.sleep(<span class="number">10</span>);&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;&#125;</span><br><span class="line">						pt.tool=<span class="string">"平底锅"</span>;</span><br><span class="line">					&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">						pt.name=<span class="string">"核桃"</span>;</span><br><span class="line">						<span class="keyword">try</span> &#123;Thread.sleep(<span class="number">10</span>);&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;&#125;</span><br><span class="line">						pt.tool=<span class="string">"锤子"</span>;</span><br><span class="line">					&#125;</span><br><span class="line">					i=(i+<span class="number">1</span>)%<span class="number">2</span>;</span><br><span class="line">					pt.有东西=<span class="keyword">true</span>;</span><br><span class="line">					pt.notify();  <span class="comment">//执行之后,生产者和消费者重新会抢夺对象锁,并不是从刚才wait进行执行</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="class"><span class="keyword">class</span> 消费者 <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">		<span class="keyword">public</span> 消费者(平台 pt)&#123;</span><br><span class="line">			<span class="keyword">this</span>.pt=pt;</span><br><span class="line">		&#125;</span><br><span class="line">		平台 pt;</span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">				<span class="keyword">synchronized</span> (pt) &#123;</span><br><span class="line">					<span class="keyword">if</span>(pt.有东西==<span class="keyword">false</span>)&#123;</span><br><span class="line">						<span class="keyword">try</span> &#123;</span><br><span class="line">							pt.wait();  <span class="comment">//如果平台没有东西,进行等待,释放锁,让生产者生产</span></span><br><span class="line">						&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">							e.printStackTrace();</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">					System.out.print(pt.name);</span><br><span class="line">					<span class="keyword">try</span> &#123;Thread.sleep(<span class="number">10</span>);&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;&#125;</span><br><span class="line">					System.out.println(<span class="string">"--"</span>+pt.tool);</span><br><span class="line">					pt.有东西=<span class="keyword">false</span>;</span><br><span class="line">					pt.notify();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">wait方法进行等待的时候,会释放锁的资源,让其他线程抢夺</span><br><span class="line">如果不释放锁,其他线程是抢夺不到的</span><br></pre></td></tr></table></figure>
<h1 id="10-生产者消费者程序的优化"><a href="#10-生产者消费者程序的优化" class="headerlink" title="10 生产者消费者程序的优化"></a>10 生产者消费者程序的优化</h1><p>​        </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">			平台 pt=<span class="keyword">new</span> 平台();</span><br><span class="line">			Thread t1=<span class="keyword">new</span> Thread(<span class="keyword">new</span> 生产者(pt));</span><br><span class="line">			Thread t2=<span class="keyword">new</span> Thread(<span class="keyword">new</span> 消费者(pt));</span><br><span class="line">			t1.start();</span><br><span class="line">			t2.start();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="class"><span class="keyword">class</span> 平台</span>&#123;</span><br><span class="line">		String name;  <span class="comment">//鸡蛋 核桃</span></span><br><span class="line">		String tool;  <span class="comment">//平底锅 锤子</span></span><br><span class="line">		<span class="keyword">boolean</span> 有东西=<span class="keyword">false</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//放东西</span></span><br><span class="line">		<span class="function"><span class="keyword">synchronized</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(String name,String tool)</span></span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="keyword">this</span>.有东西==<span class="keyword">true</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					<span class="keyword">this</span>.wait(); <span class="comment">//等待,并释放锁</span></span><br><span class="line">				&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">this</span>.name=name;</span><br><span class="line">			<span class="keyword">this</span>.tool=tool;</span><br><span class="line">			<span class="keyword">this</span>.有东西=<span class="keyword">true</span>;</span><br><span class="line">			<span class="keyword">this</span>.notify();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//取东西</span></span><br><span class="line">		<span class="function"><span class="keyword">synchronized</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">get</span><span class="params">()</span></span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="keyword">this</span>.有东西==<span class="keyword">false</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					<span class="keyword">this</span>.wait();  <span class="comment">//如果平台没有东西,进行等待,释放锁,让生产者生产</span></span><br><span class="line">				&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			System.out.print(<span class="keyword">this</span>.name);</span><br><span class="line">			<span class="keyword">try</span> &#123;Thread.sleep(<span class="number">10</span>);&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;&#125;</span><br><span class="line">			System.out.println(<span class="string">"--"</span>+<span class="keyword">this</span>.tool);</span><br><span class="line">			<span class="keyword">this</span>.有东西=<span class="keyword">false</span>;</span><br><span class="line">			<span class="keyword">this</span>.notify();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="class"><span class="keyword">class</span> 生产者 <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">		<span class="keyword">public</span> 生产者(平台 pt)&#123;</span><br><span class="line">			<span class="keyword">this</span>.pt=pt;</span><br><span class="line">		&#125;</span><br><span class="line">		平台 pt;</span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">			<span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">				<span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">0</span>)&#123;</span><br><span class="line">					pt.put(<span class="string">"鸡蛋"</span>, <span class="string">"平底锅"</span>);</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					pt.put(<span class="string">"核桃"</span>, <span class="string">"锤子"</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				i=(i+<span class="number">1</span>)%<span class="number">2</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="class"><span class="keyword">class</span> 消费者 <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">		<span class="keyword">public</span> 消费者(平台 pt)&#123;</span><br><span class="line">			<span class="keyword">this</span>.pt=pt;</span><br><span class="line">		&#125;</span><br><span class="line">		平台 pt;</span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">				pt.get();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h1 id="11-线程的终止"><a href="#11-线程的终止" class="headerlink" title="11 线程的终止"></a>11 线程的终止</h1><p>​        </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>) 设置线程的结束标志 (最常用的方式)</span><br><span class="line"><span class="number">2</span>) Interrupt();</span><br><span class="line"><span class="number">3</span>) stop;   <span class="comment">//废弃,容易引起死锁</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//例子 领导讲话的时候,员工就一直鼓掌,领导讲到第90句的时候,员工停止鼓掌</span></span><br><span class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		Emp e=<span class="keyword">new</span> Emp();</span><br><span class="line">		<span class="keyword">new</span> Thread(e).start();</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(i==<span class="number">90</span>)&#123;</span><br><span class="line">				e.stopMe(<span class="keyword">true</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			System.out.println(<span class="string">"领导讲话:"</span>+i);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Emp</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">boolean</span> isStop=<span class="keyword">false</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stopMe</span><span class="params">(<span class="keyword">boolean</span> isStop)</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.isStop=isStop;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">while</span>(isStop==<span class="keyword">false</span>)&#123;</span><br><span class="line">			System.out.println(<span class="string">"员工鼓掌....."</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//例子 2) Interrupt</span></span><br><span class="line">	这一方法实际上完成的是，在线程受到阻塞时抛出一个中断信号，</span><br><span class="line">	这样线程就得以退出阻塞的状态。更确切的说，</span><br><span class="line">	如果线程被Object.wait, Thread.join和Thread.sleep三种方法之一阻塞，</span><br><span class="line">	那么，它将接收到一个中断异常（InterruptedException），</span><br><span class="line">	从而提早地终结被阻塞状态.如果线程没有被阻塞，这时调用interrupt()将不起作用</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">			Thread t = <span class="keyword">new</span> Thread(<span class="keyword">new</span> ATest());</span><br><span class="line">			t.start();</span><br><span class="line">			System.out.println(<span class="string">"************************"</span>);</span><br><span class="line">			System.out.println(<span class="string">"********我是主线程*******"</span>);</span><br><span class="line">			System.out.println(<span class="string">"************************"</span>);</span><br><span class="line">			t.interrupt();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">ATest</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">					System.out.println(<span class="string">"我是子线程"</span>);</span><br><span class="line">					<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">900000</span>; i++) &#123;</span><br><span class="line"></span><br><span class="line">					&#125;</span><br><span class="line">					Thread.sleep(<span class="number">50</span>); <span class="comment">//当阻塞线程时,发现此线程调用了interrupt()方法,就会抛出一个异常,也就停止了线程</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">				System.out.println(<span class="string">"子綫程的run結束了"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"><span class="comment">//附 join方法  主要作用是为了同步,他可以使线程之间的异步执行变成同步执行</span></span><br><span class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">				JoinTest t1=<span class="keyword">new</span> JoinTest(<span class="string">"小明"</span>);</span><br><span class="line">				JoinTest t2=<span class="keyword">new</span> JoinTest(<span class="string">"小东"</span>);</span><br><span class="line">				Thread th1=<span class="keyword">new</span> Thread(t1);</span><br><span class="line">				th1.start();</span><br><span class="line">				th1.join();  <span class="comment">//此时小明先执行完,小东才开始执行,由原先的交叉异步执行,变成现在的同步</span></span><br><span class="line">				<span class="comment">//th1.join(5000); 先同步5秒,在异步执行</span></span><br><span class="line">				Thread th2=<span class="keyword">new</span> Thread(t2);</span><br><span class="line">				th2.start();</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="class"><span class="keyword">class</span> <span class="title">JoinTest</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="title">JoinTest</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">				<span class="keyword">this</span>.name=name;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">public</span> String name;</span><br><span class="line">			<span class="meta">@Override</span></span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++)&#123;</span><br><span class="line">					<span class="keyword">try</span> &#123;</span><br><span class="line">						Thread.sleep(<span class="number">100</span>);</span><br><span class="line">					&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">						e.printStackTrace();</span><br><span class="line">					&#125;</span><br><span class="line">					System.out.println(name+<span class="string">":"</span>+i);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">           &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">面试题：现在有T1、T2、T3三个线程，你怎样保证T2在T1执行完后执行，T3在T2执行完后执行？</span><br><span class="line">		可以使用join进行</span><br></pre></td></tr></table></figure>
<p>​    </p>
<h1 id="12-后台线程"><a href="#12-后台线程" class="headerlink" title="12 后台线程"></a>12 后台线程</h1><p>​            </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">后台线程也叫做:精灵线程或者守护线程</span><br><span class="line"><span class="number">1</span>:系统中可以同时运行前台线程和后台线程(比如:java虚拟机)</span><br><span class="line"><span class="number">2</span>:当系统中没有前台线程的时候,后台线程会结束</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">可以使用</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">setDaemon</span><span class="params">(<span class="keyword">boolean</span> on)</span> 是在Thread类中</span></span><br><span class="line"><span class="function">如果传<span class="keyword">true</span>,则将一个线程变为后台线程</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		MyTest my=<span class="keyword">new</span> MyTest();</span><br><span class="line">		Thread t1=<span class="keyword">new</span> Thread(my);</span><br><span class="line">		t1.setDaemon(<span class="keyword">true</span>);</span><br><span class="line">		t1.start();</span><br><span class="line">		System.out.println(<span class="string">"================"</span>);</span><br><span class="line">		System.out.println(<span class="string">"================"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyTest</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">			System.out.println(<span class="string">"正在运行"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//此时MyTest变成了后台线程,而前台线程只有主线程,所以当主方法结束之后,前台线程就不存在了</span></span><br><span class="line"><span class="comment">//因此后台线程也就停止,包括虚拟机线程</span></span><br></pre></td></tr></table></figure>
<h1 id="13-JDK-1-5-以后的-java-util-concurrent-locks"><a href="#13-JDK-1-5-以后的-java-util-concurrent-locks" class="headerlink" title="13 JDK 1.5 以后的 java.util.concurrent.locks"></a>13 JDK 1.5 以后的 java.util.concurrent.locks</h1><p>​        </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">自JDK1.5以后，在java.util.concurrent.locks包中定义了Lock接口</span><br><span class="line">并提供了常用的两种锁实现类</span><br><span class="line">   ReentrantLock      <span class="comment">//重入锁（互斥锁） 如果一个线程已经获得了锁，其内部还可以多次申请该锁成功。那么我们就称该锁为可重入锁</span></span><br><span class="line">   ReentrantReadWriteLock   <span class="comment">//读写锁  能获取读锁和写锁，在读写操作时分别调用对应的锁</span></span><br><span class="line"></span><br><span class="line">主要介绍：ReentrantLock <span class="comment">//Reentrant 这个单词,是可重入的意思</span></span><br><span class="line">ReenTrantLock可以指定是公平锁还是非公平锁。而<span class="keyword">synchronized</span>只能是非公平锁。所谓的公平锁就是先等待的线程先获得锁。</span><br><span class="line">可重入锁的原理是在锁内部维护了一个线程标示，标示该锁目前被那个线程占用，然后关联一个计数器，</span><br><span class="line">一开始计数器值为<span class="number">0</span>，说明该锁没有被任何线程占用，</span><br><span class="line">当一个线程获取了该锁，计数器会变成<span class="number">1</span>，其他线程在获取该锁时候发现锁的所有者不是自己所以被阻塞，</span><br><span class="line">当释放锁后计数器会-<span class="number">1</span>，当计数器为<span class="number">0</span>时候，锁里面的线程标示重置为<span class="keyword">null</span>,这时</span><br><span class="line">候阻塞的线程会被唤醒来获取该锁.</span><br><span class="line">它拥有与<span class="keyword">synchronized</span> 相同的并发性和内存语义，但是添加了类似锁投票、定时锁等候和可中断锁等候的一些特性。</span><br><span class="line">此外，它还提供了在激烈争用情况下更佳的性能。</span><br><span class="line">（换句话说，当许多线程都想访问共享资源时，JVM 可以花更少的时候来调度线程，把更多时间</span><br><span class="line">用在执行线程上。）</span><br><span class="line"></span><br><span class="line">	<span class="comment">//例子</span></span><br><span class="line">	Lock lock=<span class="keyword">new</span> ReentrantLock();  <span class="comment">//可重入锁</span></span><br><span class="line">	<span class="keyword">try</span>&#123;</span><br><span class="line">		lock.lock();  <span class="comment">//上锁</span></span><br><span class="line">		<span class="comment">/*.....</span></span><br><span class="line"><span class="comment">		..... 同步的代码</span></span><br><span class="line"><span class="comment">		.....*/</span></span><br><span class="line">	&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">		lock.unlock();  <span class="comment">//释放改锁</span></span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">	<span class="comment">//例子 读写锁   读读不互斥----读写互斥----写写互斥</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">		<span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String,String&gt; map=<span class="keyword">new</span> HashMap&lt;String,String&gt;();</span><br><span class="line">		<span class="keyword">private</span> <span class="keyword">static</span> ReentrantReadWriteLock rwl=<span class="keyword">new</span> ReentrantReadWriteLock();</span><br><span class="line">		<span class="keyword">private</span> <span class="keyword">static</span> Lock w=rwl.writeLock();</span><br><span class="line">		<span class="keyword">private</span> <span class="keyword">static</span> Lock r=rwl.readLock();</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">get</span><span class="params">(String key)</span></span>&#123;</span><br><span class="line">			r.lock();</span><br><span class="line">			<span class="keyword">try</span>&#123;</span><br><span class="line">				<span class="keyword">return</span> map.get(key); <span class="comment">//读锁/共享锁   可以多个线程去读</span></span><br><span class="line">			&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">				r.unlock();</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">put</span><span class="params">(String key,String value)</span></span>&#123;</span><br><span class="line">			w.lock();</span><br><span class="line">			<span class="keyword">try</span>&#123;</span><br><span class="line">				<span class="keyword">return</span> map.put(key, value); <span class="comment">//写锁/排他锁  只能有一个线程能操作</span></span><br><span class="line">			&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">				w.unlock();</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"> Lock 和  <span class="keyword">synchronized</span> 的区别:</span><br><span class="line"><span class="number">1</span>、Lock是一个接口，而synchionized是java中的关键字，<span class="keyword">synchronized</span>是内置语言实现的。</span><br><span class="line"><span class="number">2</span>、<span class="keyword">synchronized</span>在发生异常时能够自动释放占有锁，因此不会导致死锁现象发生；</span><br><span class="line">   而Lock在发生异常时，若不是主动unLock()，有可能会出现死锁现象。</span><br><span class="line"><span class="number">3</span>、Lock可以让等待锁的线程响应中断；使用<span class="keyword">synchronized</span>,等待的线程会一直等待下去，不能响应中断。</span><br><span class="line"><span class="number">4</span>、Lock可以判断是否成功获取锁，而<span class="keyword">synchronized</span>无法办到。</span><br><span class="line"><span class="number">5</span>、Lock可以提高多个线程进行读操作的效率。</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">			MyThread my = <span class="keyword">new</span> MyThread();</span><br><span class="line">			<span class="keyword">new</span> Thread(my).start();</span><br><span class="line">			<span class="keyword">new</span> Thread(my).start();</span><br><span class="line">			<span class="keyword">new</span> Thread(my).start();</span><br><span class="line">			<span class="keyword">new</span> Thread(my).start();</span><br><span class="line">			<span class="keyword">new</span> Thread(my).start();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">		<span class="keyword">static</span> <span class="keyword">int</span> ticket = <span class="number">100</span>;</span><br><span class="line">		<span class="keyword">static</span> Lock lock = <span class="keyword">new</span> ReentrantLock();</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">				lock.lock();</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					<span class="keyword">if</span> (ticket &gt; <span class="number">0</span>) &#123;</span><br><span class="line">						<span class="keyword">try</span> &#123;</span><br><span class="line">							Thread.sleep(<span class="number">10</span>);</span><br><span class="line">						&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">							e.printStackTrace();</span><br><span class="line">						&#125;</span><br><span class="line">						System.out.println(<span class="string">"车站正在卖第"</span> + ticket-- + <span class="string">"张"</span>);</span><br><span class="line">					&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">					lock.unlock();</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p> List、Map、Set三个接口，存取元素时，各有什么特点？ </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">List来自于Collection来的 元素有序(可以按照索引进行访问),可以存重复的元素</span><br><span class="line">		ArrayList  LinkedList Vector</span><br><span class="line">		</span><br><span class="line">		CopyOnWriteArrayList</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Set来自于Collection来的, 元素无序	,不可以存重复的元素	</span><br><span class="line">	hashcode() equals()</span><br><span class="line">	</span><br><span class="line">	HashSet TreeSet</span><br><span class="line">	</span><br><span class="line">Map  <span class="comment">//键值对结构</span></span><br><span class="line">	HashMap</span><br><span class="line">	Hashtable   </span><br><span class="line">	</span><br><span class="line">	<span class="number">2</span>) Collection 和 Collections的区别。 		</span><br><span class="line">		Collection 是单列集合框架的根接口 </span><br><span class="line">	    Collections 是一个工具类,里面的方法全是静态的,用来操作 Collection 集合</span><br></pre></td></tr></table></figure>
<p>​      </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">附:</span><br><span class="line">两个对象,equals相等,hashcode()一定相等   <span class="comment">//this==obj;</span></span><br><span class="line">两个对象,hashcode()相等,equals不一定  (可能哈希冲突)</span><br><span class="line">		</span><br><span class="line">哈希表是如何快速定位的</span><br><span class="line">	map.put(<span class="number">33</span>,<span class="string">""</span>);</span><br><span class="line">	<span class="number">33</span>.hashcode()% 哈希表.length()</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span>) sleep() 和 wait() 有什么区别? </span><br><span class="line">		在同步代码块中,有锁的情况下,</span><br><span class="line">		sleep 不会释放锁 ,不用别人唤醒,</span><br><span class="line">		wait() 会释放锁, 需要别人来唤醒</span><br></pre></td></tr></table></figure>
<p>​<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span>) 下面两个方法同步吗？</span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">	</span>&#123;</span><br><span class="line">			<span class="function"><span class="keyword">synchronized</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sayHello3</span><span class="params">()</span>  </span></span><br><span class="line"><span class="function">			</span>&#123;</span><br><span class="line">				...</span><br><span class="line">			&#125;	</span><br><span class="line"><span class="function"><span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">getX</span><span class="params">()</span></span>&#123;&#125; </span><br><span class="line">&#125;	</span><br><span class="line">不同步,因为锁不同</span><br></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span>) 多线程有几种实现方法?同步有几种实现方法</span><br><span class="line">		Java多线程实现方式主要有四种：</span><br><span class="line">			<span class="number">1</span>.继承Thread类、</span><br><span class="line">			<span class="number">2</span>.实现Runnable接口、</span><br><span class="line">			<span class="number">3</span>.实现Callable接口通过FutureTask包装器来创建多线程、</span><br><span class="line">			<span class="number">4</span>.使用线程池完成多线程。</span><br></pre></td></tr></table></figure>
<p>​<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">同步的实现方面有几种：</span><br><span class="line"><span class="number">1</span>.同步方法 </span><br><span class="line"><span class="number">2</span>.同步代码块 </span><br><span class="line"><span class="number">3</span>.使用重入锁实现线程同步</span><br></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">简述<span class="keyword">synchronized</span>和java.util.concurrent.locks.Lock的异同 </span><br><span class="line">        <span class="number">1</span>、Lock是一个接口，而synchionized是java中的关键字，<span class="keyword">synchronized</span>是内置语言实现的。</span><br><span class="line">		<span class="number">2</span>、<span class="keyword">synchronized</span>在发生异常时能够自动释放占有锁，因此不会导致死锁现象发生；</span><br><span class="line">		   而Lock在发生异常时，若不是主动unLock()，有可能会早场死锁现象。</span><br><span class="line">		<span class="number">3</span>、Lock可以让等待锁的线程响应中断；使用<span class="keyword">synchronized</span>,等待的线程会一直等待下去，不能响应中断。</span><br><span class="line">		<span class="number">4</span>、Lock可以判断是否成功获取锁，而<span class="keyword">synchronized</span>无法办到。</span><br><span class="line">		<span class="number">5</span>、Lock可以提高多个线程进行读操作的效率。</span><br></pre></td></tr></table></figure>

      
    </div>

    

    
    
    

    

    
      
    

    <div>
  
    ﻿<div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>
  
</div>
    
    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/08/02/第十四天/" rel="next" title="Java工具类、对象深浅克隆">
                <i class="fa fa-chevron-left"></i> Java工具类、对象深浅克隆
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/08/02/第十六天/" rel="prev" title="java的IO流">
                java的IO流 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">49</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">7</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
            </nav>
          

          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-进程和线程"><span class="nav-number">1.</span> <span class="nav-text">1 进程和线程</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-用-Thread类创建线程"><span class="nav-number">2.</span> <span class="nav-text">2 用 Thread类创建线程</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-线程的状态"><span class="nav-number">3.</span> <span class="nav-text">3 线程的状态</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-售票程序"><span class="nav-number">4.</span> <span class="nav-text">4 售票程序</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-使用Runable接口实现多线程-做常用的方式"><span class="nav-number">5.</span> <span class="nav-text">5 使用Runable接口实现多线程  (做常用的方式)</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6-实现线程的另外两种方式"><span class="nav-number">6.</span> <span class="nav-text">6 实现线程的另外两种方式</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7-死锁"><span class="nav-number">7.</span> <span class="nav-text">7 死锁</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#8-生产者消费者的问题"><span class="nav-number">8.</span> <span class="nav-text">8 生产者消费者的问题</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#9-线程间的通信"><span class="nav-number">9.</span> <span class="nav-text">9 线程间的通信</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#10-生产者消费者程序的优化"><span class="nav-number">10.</span> <span class="nav-text">10 生产者消费者程序的优化</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#11-线程的终止"><span class="nav-number">11.</span> <span class="nav-text">11 线程的终止</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#12-后台线程"><span class="nav-number">12.</span> <span class="nav-text">12 后台线程</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#13-JDK-1-5-以后的-java-util-concurrent-locks"><span class="nav-number">13.</span> <span class="nav-text">13 JDK 1.5 以后的 java.util.concurrent.locks</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder"></span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.1.1</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.1"></script>

  <script src="/js/motion.js?v=7.1.1"></script>



  
  


  <script src="/js/schemes/muse.js?v=7.1.1"></script>



  
  <script src="/js/scrollspy.js?v=7.1.1"></script>
<script src="/js/post-details.js?v=7.1.1"></script>



  


  <script src="/js/next-boot.js?v=7.1.1"></script>


  

  

  

  


  


  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

<script type="text/javascript" src="/js/love.js"></script>
<script type="text/javascript" src="/js/dynamic_bg.js"></script>
</body>

</html>

